# ============================================================================
# Production PaaS Stack Configuration Example
# ============================================================================
# Copy this file to ~/.paas-config.env and customize for your deployment
# Then run: source ~/.paas-config.env && chezmoi apply -v
# ============================================================================

# ============================================================================
# DEPLOYMENT SETTINGS
# ============================================================================

export DEPLOYMENT_PROFILE="production"
export TENANT_DOMAIN="paas.local"          # Change to your domain
export TENANT_NAME="production-1"
export TIMEZONE="UTC"                      # e.g., "Europe/Budapest"
export ACME_EMAIL="admin@paas.local"       # For Let's Encrypt certificates

# Media and downloads paths (optional)
export MEDIA_ROOT="./media"
export DOWNLOADS_ROOT="./downloads"

# ============================================================================
# CORE SERVICES (Required for Production)
# ============================================================================

export ENABLE_POSTGRES="true"              # Central database - REQUIRED
export ENABLE_LLDAP="true"                 # LDAP auth - REQUIRED for SSO
export ENABLE_AUTHELIA="true"              # SSO provider - REQUIRED
export ENABLE_VAULTWARDEN="true"           # Password manager - Recommended
export ENABLE_HOMEPAGE="true"              # Dashboard - Recommended

# ============================================================================
# DATABASE CREDENTIALS
# ============================================================================

# PostgreSQL
export POSTGRES_DB="paas_db"
export POSTGRES_USER="paas_user"
export POSTGRES_PASSWORD="$(openssl rand -base64 32)"  # Generate secure password

# MariaDB (only if enabled)
export ENABLE_MARIADB="false"
# export MYSQL_ROOT_PASSWORD="$(openssl rand -base64 32)"
# export MYSQL_DATABASE="paas_db"
# export MYSQL_USER="paas_user"
# export MYSQL_PASSWORD="$(openssl rand -base64 32)"

# ============================================================================
# AUTHENTICATION SERVICES
# ============================================================================

# LLDAP Configuration
export LLDAP_JWT_SECRET="$(openssl rand -base64 32)"
export LLDAP_ADMIN_PASSWORD="changeme_lldap_admin_password"  # CHANGE THIS!
# LDAP_BASE_DN is auto-generated from TENANT_DOMAIN if not set
# export LDAP_BASE_DN="dc=paas,dc=local"

# Authelia Configuration
export AUTHELIA_JWT_SECRET="$(openssl rand -base64 64)"
export AUTHELIA_SESSION_SECRET="$(openssl rand -base64 64)"
export AUTHELIA_STORAGE_KEY="$(openssl rand -base64 32)"

# ============================================================================
# PASSWORD MANAGER
# ============================================================================

# Vaultwarden (Bitwarden-compatible)
export VAULTWARDEN_ADMIN_TOKEN="$(openssl rand -base64 32)"
export VAULTWARDEN_SIGNUPS_ALLOWED="true"  # Set to "false" after initial setup

# ============================================================================
# OPTIONAL: FILE STORAGE AND SYNC
# ============================================================================

export ENABLE_NEXTCLOUD="false"
# If enabling Nextcloud, set these:
# export NEXTCLOUD_ADMIN_USER="admin"
# export NEXTCLOUD_ADMIN_PASSWORD="changeme_nextcloud_password"
# export NEXTCLOUD_MEDIA_PATH="./media/nextcloud"

# ============================================================================
# OPTIONAL: DEVELOPMENT TOOLS
# ============================================================================

# GitLab (Full-featured, requires 4GB+ RAM)
export ENABLE_GITLAB="false"
# export GITLAB_ROOT_PASSWORD="changeme_gitlab_root_password"

# Gitea (Lightweight alternative to GitLab)
export ENABLE_GITEA="false"
# export GITEA_DISABLE_REGISTRATION="false"

# ============================================================================
# OPTIONAL: MEDIA SERVICES
# ============================================================================

# Jellyfin Media Server
export ENABLE_JELLYFIN="false"
# export JELLYFIN_MOVIES="./media/movies"
# export JELLYFIN_TV="./media/tv"
# export JELLYFIN_MUSIC="./media/music"

# Immich Photo Management
export ENABLE_IMMICH="false"
# export IMMICH_MEDIA_PATH="./media/immich"
# export ENABLE_REDIS="true"  # Required for Immich

# ============================================================================
# OPTIONAL: PRODUCTIVITY TOOLS
# ============================================================================

# Vikunja Task Management
export ENABLE_VIKUNJA="false"
# export VIKUNJA_JWT_SECRET="$(openssl rand -base64 32)"

# Stirling PDF Tools
export ENABLE_STIRLING_PDF="false"

# ============================================================================
# USAGE INSTRUCTIONS
# ============================================================================
#
# 1. Copy this file:
#    cp production-config.env.example ~/.paas-config.env
#
# 2. Edit the file and change all "changeme" passwords:
#    nano ~/.paas-config.env
#
# 3. Load the configuration:
#    source ~/.paas-config.env
#
# 4. Apply with Chezmoi:
#    chezmoi apply -v
#
# 5. Verify deployment:
#    cd ~/opt/docker/production
#    docker ps
#
# ============================================================================
